<!DOCTYPE html>
<html lang="pt-BR">
<head>

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=AW-17661147688"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'AW-17661147688');
  </script>

  <!-- Zendesk Widget -->
  <script id="ze-snippet"
          src="https://static.zdassets.com/ekr/snippet.js?key=8bd1b71a-ff84-437d-a53b-3af6d91d14a8">
  </script>

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>üß† Descubra qual dieta funciona pro seu tipo de corpo</title>
  <meta name="description"
        content="Quiz interativo que indica a dieta ideal para o seu biotipo. Inclui c√°lculo de IMC, 16 combina√ß√µes Dieta√óBiotipo, WhatsApp e salvamento de lead em MySQL (cPanel).">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap"
        rel="stylesheet">

  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    :root { --brand: #22c55e; }
    body { font-family: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, Arial; }
    .container { max-width: 980px; }
    .shadow-soft { box-shadow: 0 10px 25px rgba(2, 6, 23, 0.08); }
    .hidden { display: none !important; }

    fieldset.step {
      background: linear-gradient(135deg, #d1fae5, #a7f3d0);
      border-radius: 20px;
      padding: 28px 20px 20px 20px;
      border: 1px solid #6ee7b7;
      box-shadow: 0 8px 24px rgba(16,185,129,0.20);
      transition: .2s;
    }
    fieldset.step:hover {
      transform: scale(1.01);
      box-shadow: 0 10px 28px rgba(5,150,105,0.25);
    }
    fieldset.step legend {
      font-size: 1.25rem;
      font-weight: 800;
      color: #064e3b;
      margin-bottom: 10px;
    }

    .choice label {
      background: #fff;
      border: 1.5px solid #e5e7eb;
      border-radius: 12px;
      padding: 12px;
      display: block;
      cursor: pointer;
      transition: .16s;
    }
    .choice label:hover {
      transform: translateY(-1px);
      border-color: #cbd5e1;
      box-shadow: 0 8px 18px rgba(2,6,23,0.10);
    }
    .choice input:checked + label {
      border-color: #10b981;
      box-shadow: 0 10px 24px rgba(16,185,129,0.25);
    }

    .body-card {
      background: #fff;
      border: 1.5px solid #e5e7eb;
      border-radius: 14px;
      padding: 14px;
      text-align: center;
      cursor: pointer;
      transition: .16s;
      box-shadow: 0 4px 14px rgba(2,6,23,0.06);
    }
    .body-card:hover {
      transform: translateY(-1px);
      border-color: #cbd5e1;
      box-shadow: 0 8px 18px rgba(2,6,23,0.10);
    }
    .body-card.selected {
      border-color: #10b981;
      box-shadow: 0 10px 24px rgba(16,185,129,0.25);
    }

  </style>
</head>

<body class="bg-slate-50 text-slate-900">
  <!-- Header -->
  <header class="bg-white border-b border-slate-200 sticky top-0 z-40">
    <div class="container mx-auto px-4 py-3 flex items-center justify-between">
      <div class="flex items-center gap-3">
        <div class="h-9 w-9 rounded-2xl bg-[var(--brand)]/10 flex items-center justify-center">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
               stroke="currentColor" class="h-5 w-5 text-[var(--brand)]">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 6v6l4 2"/>
          </svg>
        </div>
        <span class="font-extrabold tracking-tight">Quiz de Dieta</span>
      </div>

      <nav class="hidden md:flex gap-6 text-sm text-slate-600">
        <a href="#quiz" class="hover:text-slate-900">Quiz</a>
        <a href="#resultado" class="hover:text-slate-900">Resultado</a>
      </nav>

      <a href="#quiz"
         class="rounded-xl px-4 py-2 bg-[var(--brand)] text-white font-semibold hover:bg-emerald-600 transition">
         Come√ßar
      </a>
    </div>
  </header>

  <!-- Hero -->
  <section class="bg-gradient-to-b from-white to-slate-100">
    <div class="container mx-auto px-4 py-10 grid lg:grid-cols-2 gap-10 items-center">

      <div>
        <h1 class="text-3xl md:text-5xl font-extrabold leading-tight">
          üß† Descubra agora qual a dieta que realmente funciona com seu corpo!
        </h1>
        <p class="mt-4 text-lg text-slate-600">
          Tenha sua Dieta 100% Personalizada: Inteligente, Feita pro SEU Corpo ‚Äî Resultados Reais!
        </p>

        <div class="mt-6 flex gap-3">
          <a href="#quiz"
             class="rounded-xl px-6 py-3 bg-[var(--brand)] text-white font-semibold hover:bg-emerald-600 transition">
             Come√ßar agora
          </a>
          <span class="text-slate-500 self-center">Leva ~1 minuto</span>
        </div>
      </div>

      <div class="rounded-2xl overflow-hidden shadow-soft border border-slate-200 bg-white">
        <img src="https://images.unsplash.com/photo-1544025162-d76694265947?q=80&w=1600&auto=format&fit=crop"
             class="w-full h-72 object-cover"/>

        <div class="p-6">
          <h3 class="text-xl font-bold">Resultado personalizado</h3>
          <p class="mt-1 text-slate-600">
            Direcionamento claro combinando <strong>biotipo</strong>, <strong>IMC</strong> e <strong>perfil</strong>.
          </p>
        </div>
      </div>

    </div>
  </section>

  <!-- QUIZ -->
  <section id="quiz" class="py-10 bg-white border-t border-b border-slate-200">
    <div class="container mx-auto px-4">
      <div class="p-6 rounded-2xl bg-white border border-slate-200 shadow-soft">

        <div id="statusBanner"
             class="hidden mb-4 rounded-xl px-4 py-3 text-sm border"></div>

        <div class="flex items-center justify-between mb-4">
          <div>
            <h2 class="text-2xl font-extrabold">Responda √†s perguntas</h2>
            <p id="microcopy" class="text-slate-600 text-sm mt-1">Come√ßamos entendendo sua rotina üòâ</p>
          </div>

          <div class="w-52 text-right">
            <div class="h-2 rounded-full bg-slate-200 overflow-hidden">
              <div id="progress" class="h-2 bg-[var(--brand)] w-0"></div>
            </div>
            <p class="text-xs text-slate-500 mt-1">
              <span id="progressCount">0/20</span> ‚Ä¢
              <span id="pct">0%</span>
            </p>
          </div>
        </div>

        <form id="quizForm" class="grid gap-6"></form>

        <div class="mt-6 flex items-center justify-between">
          <button id="btnPrev"
                  class="rounded-xl px-4 py-2 border border-slate-300 font-semibold disabled:opacity-40"
                  disabled>
            Voltar
          </button>
        </div>

      </div>
    </div>
  </section>


  <!-- SCRIPT DO QUIZ -->
  <script>
  (function(){

    /* --------------- CONFIG ---------------- */
    var PRE_PAG_URL   = "/pre-pagamento/";
    var LEAD_ENDPOINT = "https://italomelo.com/server/save_lead.php";
    var LEAD_TOKEN    = "2a8e5cda3b49e2f6f72dc0d4a1f9f83e9c0fda8b2f7a3e1c4d6b9e7f5a2c1d8e";

    /* --------------- MICROCOPY --------------- */
    var MICROCOPY = {
      0:  "Come√ßamos entendendo sua rotina üòâ",
      4:  "√ìtimo! Continuando‚Ä¶",
      8:  "Estamos indo muito bem!",
      12: "√öltimos detalhes‚Ä¶",
      16: "Quase pronto!"
    };

    /* --------------- BIOTIPOS POR G√äNERO --------------- */
    var BODY_TYPES_MALE = [
      { key:"ECTO", name:"Ectomorfo",   image:"img/male_ecto.png" },
      { key:"MESO", name:"Mesomorfo",   image:"img/male_meso.png" },
      { key:"ENDO", name:"Endomorfo",   image:"img/male_endo.png" },
      { key:"EQUI", name:"Equilibrado", image:"img/male_equilibrado.png" }
    ];

    var BODY_TYPES_FEMALE = [
      { key:"ECTO", name:"Ectomorfo",   image:"img/female_ecto.png" },
      { key:"MESO", name:"Mesomorfo",   image:"img/female_meso.png" },
      { key:"ENDO", name:"Endomorfo",   image:"img/female_endo.png" },
      { key:"EQUI", name:"Equilibrado", image:"img/female_equilibrado.png" }
    ];

    var BODY_TYPES = BODY_TYPES_MALE;   // valor padr√£o
    /* ===========================================================
       PERGUNTAS (com biotipo modificado dinamicamente)
    ============================================================ */
    var QUESTIONS = [
      { type:"radio", q:"Vamos come√ßar.. informe seu g√™nero", a:["HOMEM","MULHER"] },
      { type:"radio", q:"Qual sua faixa et√°ria?", a:["15 a 25 anos","26 a 35 anos","36 a 49 anos","+50 anos"] },

      /* üî• PERGUNTA DE BIOTIPO ‚Äî carregada dinamicamente */
      { type:"body", q:"Agora escolha seu tipo de corpo (biotipo)", a: BODY_TYPES },

      { type:"radio", q:"Qual seu principal objetivo agora?", a:["Emagrecer r√°pido","Ganhar massa magra","Manter peso","Reduzir gordura"] },
      { type:"radio", q:"Seu n√≠vel de energia di√°rio √©‚Ä¶", a:["Baixo","Oscila","Constante","Muito alto"] },
      { type:"radio", q:"Seu apetite √©‚Ä¶", a:["Forte de manh√£","Mais fome √† noite","Pouco apetite","Muita fome sempre"] },
      { type:"radio", q:"Quantas refei√ß√µes por dia?", a:["2 ou menos","3","4 ou 5","Mais de 5"] },
      { type:"radio", q:"Fome emocional/ansiosa?", a:["Sim, muito","√Äs vezes","Raramente","Nunca"] },
      { type:"radio", q:"N√≠vel de atividade f√≠sica", a:["Sedent√°rio","Leve","Moderado","Intenso"] },
      { type:"radio", q:"Seu sono √©‚Ä¶", a:["Ruim","Regular","Bom","Excelente"] },
      { type:"radio", q:"Costuma pular o caf√© da manh√£?", a:["Sempre","√Äs vezes","Raramente","Nunca"] },
      { type:"radio", q:"Estilo de alimenta√ß√£o atual", a:["Muito carboidrato","Equilibrada","Rica em prote√≠na","Desorganizada"] },
      { type:"radio", q:"Vontade de doces", a:["Sempre","√Äs vezes","Raramente","Quase nunca"] },
      { type:"radio", q:"Rea√ß√£o ao carboidrato", a:["Engordo r√°pido","Sem efeito","D√° energia","Fico inchado"] },

      /* üî¢ Altura */
      { type:"input-height", q:"Qual sua altura? (em cm)", placeholder:"Ex.: 173" },

      /* ‚öñÔ∏è Peso */
      { type:"input-weight", q:"Qual seu peso atual? (kg)", placeholder:"Ex.: 78" },

      { type:"radio", q:"Rotina semanal", a:["Muito corrida","Organizada","Flex√≠vel","Sedent√°ria"] },
      { type:"radio", q:"Qual frase te representa?", a:["Quero resultados r√°pidos","Quero algo sustent√°vel","Quero comer bem","Quero performance m√°xima"] },
      { type:"radio", q:"Aceita seguir um plano personalizado feito pro seu corpo?", a:["Sim","Talvez","Preciso de ajuda"] }
    ];

    var selected = new Array(QUESTIONS.length).fill(null);
    var selectedGender = null;
    var heightCm = null;
    var weightKg = null;
    var current = 0;
    var bodyTypeKey = null;
    var imcValue = null;
    var imcLabel = "";

    function $(i){ return document.getElementById(i); }


    /* ===========================================================
       FUN√á√ÉO PARA ATUALIZAR BIOTIPOS QUANDO G√äNERO MUDA
    ============================================================ */
    function updateBodyTypesByGender(){
      if(selectedGender === "HOMEM"){
        BODY_TYPES = BODY_TYPES_MALE;
      } else {
        BODY_TYPES = BODY_TYPES_FEMALE;
      }
      QUESTIONS[2].a = BODY_TYPES;
    }


    /* ===========================================================
       RENDERIZA TODAS AS PERGUNTAS
    ============================================================ */
    var form = $("quizForm");

    function renderQuestions(){
      var html = "";

      for(let i=0; i<QUESTIONS.length; i++){
        let it = QUESTIONS[i];

        html += `<fieldset class="step ${i===0 ? "" : "hidden"}" data-step="${i}">
                  <legend>${i+1}. ${it.q}</legend>`;

        /* RADIO */
        if(it.type === "radio"){
          html += `<div class="mt-3 grid sm:grid-cols-2 gap-3">`;

          for(let j=0; j<it.a.length; j++){
            let letter = String.fromCharCode(65 + j);
            let id = `q${i}_${letter}`;

            html += `
              <div class="choice">
                <input type="radio" id="${id}" name="q${i}" class="hidden" value="${letter}">
                <label for="${id}">${it.a[j]}</label>
              </div>`;
          }
          html += `</div>`;
        }

        /* ALTURA */
        else if(it.type === "input-height"){
          html += `
            <div class="mt-2">
              <input id="heightCm" type="number" min="120" max="230"
                     placeholder="${it.placeholder}"
                     class="rounded-xl border-slate-300 w-full p-3">
            </div>`;
        }

        /* PESO */
        else if(it.type === "input-weight"){
          html += `
            <div class="mt-2">
              <input id="weightKg" type="number" min="35" max="250" step="0.1"
                     placeholder="${it.placeholder}"
                     class="rounded-xl border-slate-300 w-full p-3">
            </div>`;
        }

        /* BIOTIPO */
        else if(it.type === "body"){
          html += `<div class="mt-3 grid sm:grid-cols-2 md:grid-cols-4 gap-3">`;

          for(let b=0; b<BODY_TYPES.length; b++){
            let bt = BODY_TYPES[b];
            html += `
              <div class="body-card" data-body="${bt.key}">
                <img src="${bt.image}" class="mx-auto h-32 w-auto rounded-lg">
                <div class="mt-2 font-semibold">${bt.name}</div>
              </div>
            `;
          }
          html += `</div>`;
        }

        html += `</fieldset>`;
      }

      form.innerHTML = html;
      updateProgress();
    }


    /* ===========================================================
       PROGRESS BAR
    ============================================================ */
    function updateProgress(){
      $("progress").style.width = (current / QUESTIONS.length * 100) + "%";
      $("pct").textContent = Math.round(current / QUESTIONS.length * 100) + "%";
      $("progressCount").textContent = current + "/" + QUESTIONS.length;
      $("btnPrev").disabled = current === 0;
      $("microcopy").textContent = MICROCOPY[
        [16,12,8,4,0].find(x => current >= x)
      ];
    }


    /* ===========================================================
       IR PARA UM STEP ESPEC√çFICO
    ============================================================ */
    function gotoStep(n){
      form.querySelectorAll(".step").forEach(s => s.classList.add("hidden"));
      let next = form.querySelector(`.step[data-step="${n}"]`);
      if(next) next.classList.remove("hidden");
      current = n;
      updateProgress();
      window.scrollTo({top: quiz.offsetTop - 20, behavior:"smooth"});
    }
    /* ===========================================================
       EVENTOS DO QUIZ (sele√ß√£o geral)
    ============================================================ */
    document.addEventListener("change", function(e){
      let t = e.target;
      if(!t) return;

      /* ---------------- G√äNERO ---------------- */
      if(t.name === "q0"){
        selectedGender = (t.value === "A") ? "HOMEM" : "MULHER";

        updateBodyTypesByGender();
        renderQuestions();

        /* Avan√ßa automaticamente para a pr√≥xima pergunta */
        current = 1;
        gotoStep(1);
        return;
      }

      /* ---------------- INPUT ALTURA ---------------- */
      if(t.id === "heightCm"){
        let v = parseInt(t.value, 10);
        if(!isNaN(v) && v >= 120 && v <= 230){
          heightCm = v;
          computeIMC();
          setTimeout(() => gotoStep(current + 1), 200);
        }
      }

      /* ---------------- INPUT PESO ---------------- */
      if(t.id === "weightKg"){
        let w = parseFloat(t.value);
        if(!isNaN(w) && w >= 35 && w <= 250){
          weightKg = w;
          computeIMC();
          setTimeout(() => gotoStep(current + 1), 200);
        }
      }

      /* ---------------- RADIO NORMAL ---------------- */
      if(t.type === "radio" && t.name.startsWith("q")){
        setTimeout(() => gotoStep(current + 1), 150);
      }
    });

    /* ===========================================================
       EVENTO ‚Äî SELE√á√ÉO DO BIOTIPO
    ============================================================ */
    form.addEventListener("click", function(e){
      let card = e.target.closest(".body-card");
      if(!card) return;

      bodyTypeKey = card.getAttribute("data-body");

      form.querySelectorAll(".body-card").forEach(c => c.classList.remove("selected"));
      card.classList.add("selected");

      setTimeout(() => gotoStep(current + 1), 200);
    });


    /* ===========================================================
       C√ÅLCULO DO IMC
    ============================================================ */
    function computeIMC(){
      if(heightCm && weightKg){
        let m = heightCm / 100;
        let v = weightKg / (m * m);

        imcValue = Math.round(v * 10) / 10;

        if(v < 18.5) imcLabel = "abaixo do peso";
        else if(v < 25) imcLabel = "faixa saud√°vel";
        else if(v < 30) imcLabel = "sobrepeso";
        else imcLabel = "obesidade leve";
      }
    }


    /* ===========================================================
       RESULTADO ‚Äî COMBINA√á√ïES
    ============================================================ */
    function finalizeResult(){
      let resultEl = document.getElementById("resultado");
      let titleEl = document.getElementById("resultTitle");
      let descEl = document.getElementById("resultDesc");

      /* Seleciona a dieta mais votada */
      let scores = {A:0, B:0, C:0, D:0};

      selected.forEach(v => { if(scores[v]) scores[v]++; });

      let dietKey = Object.keys(scores).reduce((a,b) => scores[a] > scores[b] ? a : b);

      /* Default */
      let title = "Plano Personalizado";
      let desc = "Seu plano foi ajustado ao seu perfil.";

      /* Mapeamento do bodyType */
      let bodyName = "Equilibrado";

      let BT = BODY_TYPES.find(b => b.key === bodyTypeKey);
      if(BT) bodyName = BT.name;

      /* Monta descri√ß√£o final */
      desc = `Seu biotipo √© ${bodyName}. Sua alimenta√ß√£o ser√° ajustada para maximizar seus resultados.`;

      if(imcValue){
        desc += ` IMC ${imcValue} (${imcLabel}).`;
      }

      document.getElementById("quiz").classList.add("hidden");
      resultEl.classList.remove("hidden");

      titleEl.textContent = title;
      descEl.textContent = desc;

      localStorage.setItem("quiz_result_body_name", bodyName);
      localStorage.setItem("quiz_imc_value", imcValue);
      localStorage.setItem("quiz_imc_label", imcLabel);
    }


    /* ===========================================================
       FINAL DO QUIZ
    ============================================================ */
    function nextStep(){
      if(current >= QUESTIONS.length - 1){
        finalizeResult();
        return;
      }
      gotoStep(current + 1);
    }


    /* ===========================================================
       SALVAR LEAD E ENVIAR PARA PR√â PAGAMENTO
    ============================================================ */
    window.handleLead = async function(event){
      event.preventDefault();

      let nome  = document.getElementById("nome").value.trim();
      let email = document.getElementById("email").value.trim();
      let whats = document.getElementById("whats").value.trim();

      let ref = "ref-" + Date.now() + "-" + Math.random().toString(36).substr(2,6);

      let fd = new FormData();
      fd.append("token", LEAD_TOKEN);
      fd.append("ref", ref);
      fd.append("name", nome);
      fd.append("email", email);
      fd.append("phone", whats);
      fd.append("diet_title", "");
      fd.append("body_type", localStorage.getItem("quiz_result_body_name") || "");
      fd.append("imc_value", localStorage.getItem("quiz_imc_value") || "");
      fd.append("imc_label", localStorage.getItem("quiz_imc_label") || "");

      try { await fetch(LEAD_ENDPOINT, {method:"POST", body:fd}); } catch(e){}

      let url = new URL(PRE_PAG_URL, location.origin);
      url.searchParams.set("ref", ref);
      url.searchParams.set("nome", nome);
      url.searchParams.set("email", email);
      url.searchParams.set("whats", whats);

      location.href = url.toString();
    };


    /* ===========================================================
       WHATSAPP DEPOIS DO PAGAMENTO
    ============================================================ */
    (function(){
      let params = new URLSearchParams(location.search);
      if(params.get("status") !== "approved") return;

      setTimeout(function(){

        let nome = localStorage.getItem("lead_nome") || "Cliente";
        let body = localStorage.getItem("quiz_result_body_name") || "";
        let imc  = localStorage.getItem("quiz_imc_value") || "";
        let lbl  = localStorage.getItem("quiz_imc_label") || "";

        let msg =
          "Oi, sou " + nome + "!\n" +
          "Meu resultado do quiz foi:\n" +
          "‚Ä¢ Biotipo: " + body + "\n" +
          "‚Ä¢ IMC: " + imc + " (" + lbl + ")\n" +
          "Pagamento aprovado! Quero meu plano completo.";

        window.open("https://wa.me/5519982391022?text=" + encodeURIComponent(msg));
      }, 600);
    })();


    /* ===========================================================
       INICIALIZA√á√ÉO DO QUIZ
    ============================================================ */
    renderQuestions();
    gotoStep(0);

    document.getElementById("btnPrev").addEventListener("click", function(){
      if(current > 0) gotoStep(current - 1);
    });

  })();
  </script>


  <!-- FOOTER -->
  <footer class="py-10 text-center text-sm text-slate-500">
    <p>¬© <span id="year"></span> Dieta Pronta Online</p>
  </footer>

  <script>
    document.getElementById("year").textContent = new Date().getFullYear();
  </script>

</body>
</html>

